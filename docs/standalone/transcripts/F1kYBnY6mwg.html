<!DOCTYPE html>

<!--
Copyright 2019 Google LLC

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

  https://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="author" content="//google.com">
  <meta name="description" content="web.dev LIVE video transcript">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>F1kYBnY6mwg</title>
  <link rel="stylesheet" href="../css/main.css">
</head>

<body>

<iframe id="youtube" src="https://www.youtube.com/embed/F1kYBnY6mwg?enablejsapi=1"></iframe>

<div id="container">

<div id="options">
  <div id="google-translate"></div>
  <div>
    <input type="checkbox" id="videoSticky" checked>
    <label for="videoSticky">Video position sticky</label>
  </div>
  <div>
    <input type="checkbox" id="captionScroll" checked>
    <label for="captionScroll">Keep current caption visible</label>
  </div>
</div>

<section>
<p><span data-start="13.2" data-end="14.16">Hello, mate!</span> <span data-start="14.16" data-end="14.83">Hello!</span> <span data-start="14.83" data-end="16.58">This is like remote 203, isn't it?</span> <span data-start="16.7" data-end="17.29">It's good.</span> <span data-start="17.29" data-end="18.75">It's, yeah, it's weird.</span> <span data-start="19.41" data-end="22.08">It's like so we have almost all the technology that we need</span> <span data-start="22.08" data-end="24.84">to make this work without feeling different</span> <span data-start="25.21" data-end="26.21">but it's still different.</span> </p>
<p><span data-start="27" data-end="28.38">We'll let other people be the judge of that.</span> <span data-start="28.55" data-end="29.26">If it works or not.</span> <span data-start="29.26" data-end="30.47">That's true.</span> <span data-start="30.84" data-end="33.55">So I'm here to talk about image compression.</span> <span data-start="33.64" data-end="35.18">It's something I've been wanting to talk about for a long</span> <span data-start="35.18" data-end="36.18">time, right?</span> <span data-start="36.56" data-end="38.39">I mean, we wrote an entire app around it.</span> <span data-start="39.35" data-end="41.94">We did. And we are gonna be seeing that as part of this</span> <span data-start="41.94" data-end="42.85">talk.</span> </p>
<p><span data-start="42.85" data-end="43.81">Nice, I like it.</span> <span data-start="43.81" data-end="46.9">If you look at the studies they do across web pages, like,</span> <span data-start="46.94" data-end="49.19">images are the biggest thing on the page.</span> <span data-start="49.4" data-end="52.32">50% around about of each page is just -</span> <span data-start="53.57" data-end="56.87">50% of the bytes that go over the wire for any given page</span> <span data-start="56.91" data-end="58.7">are on average images.</span> <span data-start="58.83" data-end="61.25">Yeah. And sometimes for fun I'll go and take just like some</span> <span data-start="61.25" data-end="64.25">images from a web page and like recompress them.</span> <span data-start="64.71" data-end="67.92">And usually I can half the size of them without losing</span> <span data-start="68.05" data-end="69.46">any of the visual fidelity.</span> </p>
<p><span data-start="69.71" data-end="71.72">So it's just like so much stuff on the web could just be</span> <span data-start="71.8" data-end="74.89">compressed better. Either by using a different format,</span> <span data-start="75.22" data-end="78.47">a better encoder, or just like better settings within</span> <span data-start="78.76" data-end="79.72">a particular encoder.</span> <span data-start="79.72" data-end="81.23">Yeah, that's what I found as well.</span> <span data-start="81.27" data-end="84.02">I recently had a little experiment and felt like even</span> <span data-start="84.1" data-end="87.11">without like going into like the very</span> <span data-start="87.11" data-end="89.53">deep settings of an encoder, often</span> <span data-start="90.11" data-end="92.49">people just don't optimize their images at all.</span> <span data-start="92.53" data-end="94.74">And just like doing the default setting in Squoosh will</span> <span data-start="94.74" data-end="96.91">already give you a really decent compression</span> <span data-start="97.78" data-end="100.58">rate without losing visual fidelity.</span> <span data-start="101.2" data-end="103.08">So if you're watching this at home, if you're the kind of</span> <span data-start="103.08" data-end="105.67">person who just like saves your images out of Photoshop for</span> <span data-start="105.67" data-end="108">the web, then this is the talk for you.</span> </p>
<p><span data-start="108.42" data-end="111.3">Cause I have things to discuss because I think you're</span> <span data-start="111.3" data-end="113.26">missing out on huge performance gains.</span> <span data-start="113.67" data-end="115.09">So I want to dive into image codecs.</span> <span data-start="115.09" data-end="117.34">I want to show how they work, and I want to explore some of</span> <span data-start="117.34" data-end="118.68">the lesser known settings.</span> <span data-start="118.8" data-end="120.76">So here are the formats.</span> <span data-start="121.18" data-end="123.02">Right. We've got lossy JPEG, and WebP.</span> <span data-start="123.1" data-end="125.06">We got lossless, PNG, GIF, and also WebP.</span> <span data-start="126.19" data-end="127.86">Hang on, my friend. Hang on.</span> </p>
<p><span data-start="129.36" data-end="131.23">You put GIFs under lossless?</span> <span data-start="132.99" data-end="134.03">They are lossless.</span> <span data-start="135.95" data-end="137.7">But they're 256 colors?</span> <span data-start="138.28" data-end="141.2">Yes, but you make that change before compression.</span> <span data-start="141.29" data-end="144.41">Like the GIF compressor won't accept images more</span> <span data-start="144.41" data-end="145.58">than 256 colors.</span> </p>
<p><span data-start="145.71" data-end="147.96">So that's a step you have to run before the compression.</span> <span data-start="148.17" data-end="149.25">It's lossless. Trust me.</span> <span data-start="149.88" data-end="150">Fine.</span> <span data-start="150" data-end="152.17">Because we are going to do the same for PNG as well, but</span> <span data-start="153.51" data-end="154.47">I've got a question for you.</span> <span data-start="154.76" data-end="157.3">If you have a digital drawing,</span> <span data-start="158.76" data-end="161.05">like a drawing that's been created on a computer, which</span> <span data-start="161.05" data-end="162.14">format would you use for this?</span> <span data-start="163.64" data-end="165.02">If at all possible, SVG.</span> <span data-start="166.73" data-end="169.31">Yep, I agree with you because, in fact, it can be any</span> <span data-start="169.65" data-end="171.23">resolution, so it's ideal for drawings.</span> <span data-start="171.65" data-end="174.49">But sometimes the drawing is really complex,</span> <span data-start="174.69" data-end="177.65">so they're actually smaller and much faster as a lossless</span> <span data-start="177.7" data-end="178.7">image.</span> </p>
<p><span data-start="179.36" data-end="181.74">But then again, if the drawing has a lot of gradients and</span> <span data-start="181.74" data-end="184.29">shading, it might actually be smaller and acceptable</span> <span data-start="184.75" data-end="187.66">in a lossy format without it looking bad to the user.</span> <span data-start="188.29" data-end="190.92">So a lot of talks and articles I see about like image</span> <span data-start="190.92" data-end="193.46">compression, they try and bucket kinds of images into</span> <span data-start="193.46" data-end="195.46">formats. And I think that can be misleading.</span> <span data-start="195.46" data-end="198.26">So instead instead, what I want to do is on a talk about</span> <span data-start="198.59" data-end="200.93">what these formats actually spend their bytes on.</span> <span data-start="201.85" data-end="202.3">Yeah.</span> <span data-start="202.3" data-end="205.47">So lossy of images, it's like sharp</span> <span data-start="205.52" data-end="206.89">edges. They really struggle with that.</span> <span data-start="206.93" data-end="209.69">That will that will increase the size of the image.</span> <span data-start="210.56" data-end="213.57">And also small details in undetailed</span> <span data-start="214.02" data-end="215.98">areas. That's, kind of, that sounds confusing.</span> </p>
<p><span data-start="216.07" data-end="218.2">So we'll look at a few examples of that in a moment.</span> <span data-start="218.95" data-end="222.03">For lossless, it's color change, especially unpredictable</span> <span data-start="222.03" data-end="224.28">color change. It's another thing we'll look at some</span> <span data-start="224.28" data-end="225.29">examples of that.</span> <span data-start="225.66" data-end="228.37">And also, total number of colors impacts the file size as</span> <span data-start="228.37" data-end="230.79">well. With vector, number of shapes and also shape</span> <span data-start="231.54" data-end="232.54">complexity.</span> <span data-start="233.09" data-end="235">There's a little difference with</span> <span data-start="236.26" data-end="239.17">vector, and that's the complexity of the shapes will</span> <span data-start="239.26" data-end="242.05">actually introduce a CPU cost in the way it doesn't with</span> <span data-start="242.09" data-end="244.47">the other formats. So that's, that's something to bear in</span> <span data-start="244.47" data-end="247.27">mind. That's the TL;DR of this talk.</span> </p>
<p><span data-start="247.6" data-end="248.6">Really. That's it.</span> <span data-start="248.93" data-end="249.48">Done.</span> <span data-start="249.48" data-end="252.48">Well, thanks for doing this and I'll see you next time.</span> <span data-start="252.9" data-end="254.57">Bye bye. No, no.</span> <span data-start="254.73" data-end="256.98">I want to get to know these codecs in detail.</span> <span data-start="257.03" data-end="258.03">I'm going to dive in.</span> <span data-start="258.24" data-end="261.57">Well, just to be clear, these are categories of codecs,</span> <span data-start="261.57" data-end="264.12">as you say. Like each of these categories has multiple</span> <span data-start="264.12" data-end="265.12">codecs to offer.</span> </p>
<p><span data-start="265.78" data-end="269">And I think the basic advice should be that you just</span> <span data-start="269.04" data-end="270.54">try the same image.</span> <span data-start="270.87" data-end="273.67">Like, if you don't know which category your image falls in</span> <span data-start="274.17" data-end="276.3">just try the image in all of these codecs.</span> <span data-start="276.5" data-end="279.67">That's kind of the ideal process, right?</span> <span data-start="280.38" data-end="283.22">Yes. But you can make some educated guesses based on your</span> <span data-start="283.59" data-end="285.01">knowledge of how these things work.</span> <span data-start="285.35" data-end="287.47">So Surma, have a look at this.</span> <span data-start="287.51" data-end="290.23">I know this is difficult because you're watching this over</span> <span data-start="290.23" data-end="293.1">WebRTC, so these demos are slightly limited.</span> <span data-start="294.02" data-end="296.02">Do you notice anything about this picture?</span> </p>
<p><span data-start="298.28" data-end="301.32">Yeah. If it's not the stream compression, then</span> <span data-start="301.32" data-end="304.7">I'd say the clouds have blocky</span> <span data-start="304.78" data-end="307.24">artifacts, going about.</span> <span data-start="307.83" data-end="309.33">I think that is just stream compression.</span> <span data-start="310.12" data-end="311.37">Ah OK, then let's try this again.</span> <span data-start="315.75" data-end="317.5">When you say notice, do you want me to find something that</span> <span data-start="317.5" data-end="320.42">is wrong with the image or just something</span> <span data-start="320.71" data-end="323.59">that should help me make a guess on which codec is best for</span> <span data-start="323.72" data-end="324.72">this?</span> <span data-start="325.09" data-end="326.39">Well, I'll tell you what, if you haven't noticed it</span> <span data-start="326.39" data-end="327.93">straight away, then that's good enough for me.</span> <span data-start="328.64" data-end="331.73">So if at home, if you're watching this in full HD,</span> <span data-start="332.48" data-end="335.56">that's 1920 by 1080 — obviously, you're getting</span> <span data-start="335.65" data-end="337.73">video compression on top of that, so you're not seeing</span> <span data-start="337.73" data-end="340.82">exactly what I'm seeing — but this picture, the</span> <span data-start="340.82" data-end="343.99">brightness data is full HD 1920</span> <span data-start="344.07" data-end="346.99">by 1080, but the color data in this image</span> <span data-start="347.24" data-end="348.2">is 96 by 54.</span> </p>
<p><span data-start="349.08" data-end="351.16">That's 0.3%</span> <span data-start="352.37" data-end="355.04">of the data and you barely notice</span> <span data-start="355.71" data-end="359.25">it. Closer, you can start to see a bit discoloration</span> <span data-start="359.34" data-end="360.46">around some of the fencing.</span> <span data-start="360.63" data-end="362.63">One of the fence posts was turned into a ghost.</span> <span data-start="365.01" data-end="366.97">Yeah, like, if you have that little resolution for the</span> <span data-start="367.01" data-end="369.72">colors, the colors will start bleeding across boundaries,</span> <span data-start="370.31" data-end="372.81">even though the light data still gives the contour.</span> </p>
<p><span data-start="372.85" data-end="375.44">So that's -</span> <span data-start="375.98" data-end="376.98">really..yeah.</span> <span data-start="377.77" data-end="379.69">And this is because you've got but eyes Surma.</span> <span data-start="380.32" data-end="383.03">Like, you have these terrible human eyes that are really</span> <span data-start="383.49" data-end="385.99">bad at seeing changes in color, but you're actually pretty</span> <span data-start="385.99" data-end="386.99">good seeing changes in brightness though.</span> <span data-start="387.82" data-end="389.91">So I'm going take this image and I'm going to flip it</span> <span data-start="389.91" data-end="392.79">around so that the brightness detail is low resolution, but</span> <span data-start="393.04" data-end="394.83">the color detail is high resolution.</span> <span data-start="395.5" data-end="396.5">And here it is.</span> </p>
<p><span data-start="397.5" data-end="400.46">And the first thing you'll notice is it looks</span> <span data-start="400.46" data-end="403.05">bad, but it is the same amount of data just flipped</span> <span data-start="403.05" data-end="404.05">around.</span> <span data-start="404.88" data-end="406.22">Here, it looks fine.</span> <span data-start="408.05" data-end="410.3">You can't go this extreme in all examples.</span> <span data-start="410.35" data-end="413.14">So here's a image that has a bit more</span> <span data-start="413.89" data-end="415.23">complex data around color.</span> <span data-start="415.27" data-end="417.6">You can see this yellow stripe and the red stripe on the</span> <span data-start="417.6" data-end="419.98">car. It's like there's some details, quite blocky.</span> <span data-start="420.36" data-end="423.19">But as we start increasing the amount of color data, again,</span> <span data-start="424.65" data-end="427.24">it becomes difficult to notice. With this image, once</span> <span data-start="427.74" data-end="430.78">I get the color data to around 5% of</span> <span data-start="430.78" data-end="433.79">the brightness data, it becomes impossible to notice for</span> <span data-start="433.79" data-end="434.49">me.</span> </p>
<p><span data-start="434.49" data-end="437.5">Now, I can build a little webapp to research this.</span> <span data-start="437.5" data-end="437.91">Of course you did.</span> <span data-start="437.91" data-end="440.58">This first is the first WebGL I ever wrote,</span> <span data-start="441.04" data-end="442.04">Surma.</span> <span data-start="443.46" data-end="444.42">Oh, you did it with WebGL. That's fun!</span> <span data-start="444.42" data-end="445.96">Yes. To do the color conversion.</span> <span data-start="446.26" data-end="449.09">So it's something you can — I'll put a link to this so you</span> <span data-start="449.09" data-end="450.97">can throw your own images at it. You can get some cool</span> <span data-start="450.97" data-end="453.76">effects. You can see the individual color channels because</span> <span data-start="453.81" data-end="455.22">this is what lossy codecs do.</span> <span data-start="456.1" data-end="458.77">They call it chroma subsampling it rather than RGB,</span> <span data-start="459.48" data-end="461.9">they do brightness and then two chroma channels, two</span> <span data-start="462.56" data-end="465.36">color channels. And that means they can just discard loads</span> <span data-start="465.36" data-end="468.32">of that color data and save a lot of file size</span> <span data-start="468.32" data-end="471.11">as a result. As you mentioned earlier, you get some color</span> <span data-start="471.11" data-end="473.53">bleeding as a result, but it's barely noticeable,</span> <span data-start="473.58" data-end="477">especially in like, photographic imagery.</span> </p>
<p><span data-start="479" data-end="480.92">One more thing that lossy codecs do in</span> <span data-start="482.08" data-end="485.13">terms of lossy stuff — it's another quiz for you, Surma.</span> <span data-start="485.42" data-end="487.3">I've made an alteration to this image.</span> <span data-start="487.38" data-end="488.84">Can you see what I have done?</span> <span data-start="489.8" data-end="492.8">There is a very ominous circle between the trees.</span> <span data-start="493.3" data-end="495.43">Yes. I've drawn a circle in the sky.</span> <span data-start="495.56" data-end="497.64">There it is. But that's not all I've done.</span> <span data-start="497.64" data-end="499.56">Down here, I've replaced the brightness</span> <span data-start="500.77" data-end="502.23">data with noise.</span> <span data-start="503.06" data-end="504.06">Just noise.</span> <span data-start="506.27" data-end="507.57">But you don't really notice that at first.</span> </p>
<p><span data-start="507.57" data-end="509.49">And here's the interesting thing.</span> <span data-start="509.49" data-end="512.57">Here's a diff of the image versus the original image.</span> <span data-start="512.91" data-end="515.28">Now, the circle in the sky</span> <span data-start="515.91" data-end="518.79">is so subtle, it barely shows up.</span> <span data-start="518.87" data-end="520.54">In fact, if you are watching this with video compression,</span> <span data-start="520.54" data-end="522.96">it might not be visible at all.</span> <span data-start="522.96" data-end="524.13">I can't see it right now.</span> <span data-start="525.79" data-end="528.51">But the noise in the in the bottom there, it's like a huge</span> <span data-start="528.51" data-end="529.51">difference.</span> <span data-start="530.22" data-end="532.22">But again, you have terrible human eyes.</span> <span data-start="532.47" data-end="535.47">You're good at seeing small changes in what we call low</span> <span data-start="535.47" data-end="537.72">frequency areas, like the sky, there's not a lot going on</span> <span data-start="537.72" data-end="539.6">so you spot that small difference.</span> <span data-start="539.89" data-end="542.31">Whereas you struggle to see the changes in the high</span> <span data-start="542.31" data-end="542.73">frequency.</span> </p>
<p><span data-start="542.73" data-end="545.81">This reminds me a bit of the</span> <span data-start="545.9" data-end="549.07">blind spot that we have in our eyes where our brain fills</span> <span data-start="549.07" data-end="551.53">in the gap for us because I see the circle.</span> <span data-start="551.65" data-end="554.03">And you showed me the diff, and faded back to the</span> <span data-start="554.61" data-end="557.24">full image, I saw the circle and then the shape of the</span> <span data-start="557.33" data-end="559.79">circle started blending into the environment.</span> <span data-start="559.79" data-end="561.79">And now it looks like a bush like, I know the circle is</span> <span data-start="561.79" data-end="563.5">there, but I can't actually quite see it.</span> </p>
<p><span data-start="564" data-end="566.67">So I think it's just my brain autocorrecting and I'm quite</span> <span data-start="566.67" data-end="568.34">frustrated with my brain for doing that.</span> <span data-start="568.96" data-end="571.3">It does. And this is something that lossy image codecs</span> <span data-start="571.3" data-end="574.26">like, they take advantage of this.</span> </p>
<p><span data-start="575.26" data-end="577.26">So what they do is they'll take an image like this and</span> <span data-start="577.26" data-end="579.01">they'll divide it into eight by eight blocks.</span> <span data-start="579.43" data-end="581.85">And rather than describe these blocks pixel by pixel, they</span> <span data-start="584.19" data-end="587.23">use this. They multiply these shapes together</span> <span data-start="587.81" data-end="589.86">to form exactly the same image.</span> <span data-start="590.07" data-end="591.86">Like, not at that intensity.</span> <span data-start="591.9" data-end="593.74">Each block can be at a different intensity.</span> <span data-start="593.78" data-end="595.32">It can even be negative.</span> <span data-start="595.74" data-end="598.41">But you can reconstruct any eight by eight image</span> <span data-start="598.74" data-end="599.95">using these shapes.</span> <span data-start="600.04" data-end="603.33">And this blows my mind, like I don't believe this.</span> <span data-start="603.58" data-end="605.92">I still don't believe this, even though I built an app to</span> <span data-start="605.92" data-end="606.92">show it.</span> <span data-start="607.29" data-end="610.09">Look, I've made a little pixel art 203, for HTTP 203.</span> <span data-start="610.55" data-end="612.34">I'm not very good at pixel art, but that's what I tried to</span> <span data-start="612.34" data-end="613.34">do here.</span> </p>
<p><span data-start="615.3" data-end="618.26">But what you see below is all of those shapes at</span> <span data-start="618.26" data-end="621.68">the intensity that it uses to reconstruct that image.</span> <span data-start="623.31" data-end="625.73">So we can actually sort of apply them one by one.</span> <span data-start="626.27" data-end="629.06">And you can see as it does the low frequency things, it</span> <span data-start="629.06" data-end="631.57">starts to build up like this blurry picture.</span> <span data-start="632.32" data-end="634.61">And then as it goes and starts to do the high frequency</span> <span data-start="634.61" data-end="637.91">bits of data, the full image comes into view.</span> <span data-start="638.53" data-end="641.45">It's incredible to me that this actually works, but it</span> <span data-start="641.45" data-end="644.41">does. Doesn't save much data, really.</span> </p>
<p><span data-start="645.46" data-end="647">But let's actually take a real bit of the image.</span> <span data-start="647.04" data-end="648.58">This is the picture of the woods from before.</span> <span data-start="648.58" data-end="650.13">I'm going to pick up some of the grass.</span> <span data-start="651.92" data-end="653.92">Now, what lossy codecs will try to do is they'll try and</span> <span data-start="653.96" data-end="655.34">discard some of this data.</span> <span data-start="655.76" data-end="657.84">So you see already it's not using all of those shapes.</span> <span data-start="657.88" data-end="659.34">That's where these zeros are coming from.</span> <span data-start="659.76" data-end="662.89">But as I dropped the quality and this is like,</span> <span data-start="663.56" data-end="666.06">jpeg quality in this case, we can see more and more</span> <span data-start="666.56" data-end="668.1">of those zeros appearing.</span> </p>
<p><span data-start="669.19" data-end="671.77">And the thing about sequences of zeros, they compress</span> <span data-start="671.86" data-end="672.86">really, really well.</span> <span data-start="673.19" data-end="675.53">So we're left with an image that isn't 100% accurate.</span> <span data-start="675.69" data-end="678.07">But this is high frequency data, you don't really notice</span> <span data-start="678.36" data-end="679.36">loads of data are saved.</span> <span data-start="679.86" data-end="682.87">I mean, even here in the side by side view, it is</span> <span data-start="682.91" data-end="686.08">hard to tell which pixels are incorrect.</span> <span data-start="686.83" data-end="687.83">Exactly.</span> </p>
<p><span data-start="688.12" data-end="689.42">But let's take a different example.</span> <span data-start="689.58" data-end="692.38">So this time a curve, which might be part of like a logo or</span> <span data-start="692.38" data-end="694.63">something. And in this case, even a very small</span> <span data-start="695.8" data-end="698.22">drop in quality is introducing noise that is very</span> <span data-start="698.84" data-end="701.72">noticeable, especially if the color is solid on either side</span> <span data-start="701.72" data-end="703.72">of this curve. That's low frequency data.</span> <span data-start="704.14" data-end="706.02">This small amount of noise is really noticeable.</span> <span data-start="706.02" data-end="707.64">It's like the circle in the sky.</span> <span data-start="707.73" data-end="710.56">Right. It's — you'll see it very, very easily.</span> <span data-start="711.48" data-end="714.23">And that's why, like, lossy compression is not very good</span> <span data-start="714.4" data-end="716.4">at sharp lines next to solid color.</span> </p>
<p><span data-start="717.36" data-end="719.78">So now if you look at a picture like this, which is a</span> <span data-start="719.78" data-end="722.82">heavily compressed jpeg and zoomed in, you can see</span> <span data-start="722.99" data-end="725.08">like what it's made of. You can see the color bleed from</span> <span data-start="725.08" data-end="727.54">the subsampling. You can see the eight by eight blocks.</span> <span data-start="727.79" data-end="730.58">You can see those waves that it's using to construct that</span> <span data-start="730.79" data-end="733.5">data. And that's it, you now know how lossy compression</span> <span data-start="733.79" data-end="737.01">works. There's only two elements of loss in both JPEG</span> <span data-start="737.34" data-end="739.01">and WebP, and that's it.</span> <span data-start="739.13" data-end="740.13">You've seen them both now.</span> <span data-start="741.51" data-end="744.39">I have a question because I'm trying to remember</span> <span data-start="744.93" data-end="748.31">WebP, I think, also does</span> <span data-start="749.27" data-end="752.56">this frequency based transfrom — discrete cosine transform,</span> <span data-start="752.6" data-end="754.86">as it's called, the conversion to this frequency patterns</span> <span data-start="755.07" data-end="756.07">and you add them up.</span> </p>
<p><span data-start="756.19" data-end="758.03">And no, yeah that's, that's yeah — that's what we just saw.</span> <span data-start="758.15" data-end="758.86">Yeah.</span> <span data-start="758.86" data-end="762.07">And I think WebP does it also at bigger</span> <span data-start="762.2" data-end="765.62">block sizes. If the — if they are low noise,</span> <span data-start="765.78" data-end="767.74">but I'm not quite sure I remember correctly.</span> <span data-start="768.33" data-end="769.83">Yeah. So WebP is just better.</span> <span data-start="770.54" data-end="772.87">So this is a few of things. Like you say it can use</span> <span data-start="772.87" data-end="775.92">different size squares. It can also, when it starts</span> <span data-start="775.92" data-end="779.26">a square, it can use a nearby square as a starting point.</span> <span data-start="781.01" data-end="783.97">Also, JPEG has to use the same</span> <span data-start="784.05" data-end="786.64">mathematical conversion for every eight by eight block</span> <span data-start="787.01" data-end="787.81">in a given channel.</span> <span data-start="787.81" data-end="788.43">Right.</span> <span data-start="788.43" data-end="790.43">Whereas WebP can you can have four.</span> </p>
<p><span data-start="791.14" data-end="793.65">So it could have a different strategy for like high</span> <span data-start="793.77" data-end="795.69">detailed areas versus low detailed areas.</span> <span data-start="796.06" data-end="798.73">And it has a better lossless compression thing as well.</span> <span data-start="798.78" data-end="800.24">Uses arithmetic compression rather than Huffman.</span> <span data-start="801.65" data-end="803.57">And it has better post decode filters as well.</span> <span data-start="803.61" data-end="804.78">So it is just better.</span> <span data-start="806.03" data-end="808.41">It also supports alpha transparency as well, which JPEG</span> <span data-start="808.58" data-end="809.58">doesn't.</span> <span data-start="810.08" data-end="813.5">So why have I wasted my time talking about JPEG?</span> <span data-start="813.87" data-end="814.87">Well,</span> <span data-start="816.92" data-end="819.96">Safari does not support WebP, it's the only one browser</span> <span data-start="820" data-end="821.01">that doesn't.</span> </p>
<p><span data-start="821.34" data-end="822.42">So that's the only benefit of JPEG.</span> <span data-start="823.13" data-end="824.13">Really.</span> <span data-start="825.84" data-end="828.85">We can still use WebP for browsers that support it.</span> <span data-start="829.26" data-end="831.52">This the picture element, so we're serving WebP for</span> <span data-start="831.52" data-end="834.14">browsers that support it and falling back to JPEG for</span> <span data-start="834.27" data-end="835.94">Safari and older browsers.</span> <span data-start="836.4" data-end="838.31">There are also client hints to do on the server side.</span> <span data-start="838.36" data-end="840.57">I'm not going to go into it. I'll put some other — some</span> <span data-start="840.57" data-end="842.9">links for that, if that's what you want to do.</span> <span data-start="843.86" data-end="846.53">So let's actually compress some images.</span> <span data-start="848.32" data-end="850.45">Now, the compression tools and things like Photoshop are</span> <span data-start="850.45" data-end="853.29">not very good, which is one the reasons that</span> <span data-start="853.75" data-end="856.58">we built this — not just us two,</span> <span data-start="856.88" data-end="858.88">it was part of a team. But yes, squoosh.app.</span> <span data-start="860.17" data-end="861.55">This has the latest WebP build.</span> </p>
<p><span data-start="861.55" data-end="864.55">Also has MozJPEG, a really good JPEG encoder from Mozilla.</span> <span data-start="865.59" data-end="868.39">So I'm going to use the F1 image from before,</span> <span data-start="869.97" data-end="871.6">because it was a bit of a tricky one to compress.</span> <span data-start="872.35" data-end="873.64">First thing I'm going to do is zoom it out.</span> <span data-start="873.89" data-end="876.94">So it's the same size as it will appear on the site.</span> <span data-start="877.19" data-end="879.15">So if you've got an image that's gonna be a thousand CSS</span> <span data-start="879.56" data-end="881.86">pixels wide, but you want to look good on a high density</span> <span data-start="881.86" data-end="884.44">screen, you want a 2000 pixel wide image.</span> <span data-start="884.65" data-end="887.03">But then you want to zoom it back out, so it's the size it</span> <span data-start="887.11" data-end="888.41">will actually appear on the screen.</span> <span data-start="890.83" data-end="893.79">Now going to start with WebP in terms of compression and</span> <span data-start="893.79" data-end="895.62">all I'm going to do — I think you mentioned this before -</span> <span data-start="895.62" data-end="898.08">just bring the quality down until it looks bad,</span> <span data-start="898.63" data-end="901.13">you know. And especially with a high density image</span> <span data-start="901.63" data-end="904.63">like this, you will be surprised how low you can go</span> <span data-start="906.17" data-end="909.64">on the quality, like, it's still really barely noticeable.</span> </p>
<p><span data-start="910.51" data-end="912.01">Now, it's really tempting to do</span> <span data-start="913.6" data-end="915.68">this, but please don't like, don't put your nose to the</span> <span data-start="915.68" data-end="918.73">screen. Don't zoom in, because</span> <span data-start="918.73" data-end="921.65">if you do that, it will look bad.</span> <span data-start="922.52" data-end="923.78">It's not going to look good. Right.</span> <span data-start="924.94" data-end="926.4">The more you zoom in, the worse it will look.</span> <span data-start="926.61" data-end="928.03">Oh, look at that. That's disgusting.</span> <span data-start="928.61" data-end="931.66">But honestly, so considering that we are at</span> <span data-start="933.24" data-end="936.41">- that we just removed 98% of</span> <span data-start="936.45" data-end="939.54">the data and it still looks that good</span> <span data-start="939.67" data-end="941.75">even when zoomed in. It's kind of cool.</span> <span data-start="942.71" data-end="943.88">Yeah. Absolutely incredible.</span> <span data-start="944.63" data-end="947.59">So if anyone comes at you and says, like, oh, I took one of</span> <span data-start="947.59" data-end="950.34">the images from your website and I zoomed in by a thousand</span> <span data-start="950.34" data-end="953.43">percent and it looks bad like, just say</span> <span data-start="954.51" data-end="957.27">"OK, zoomer", and ignore them, because that's</span> <span data-start="957.98" data-end="960.23">not what real users are going to do, and you should be</span> <span data-start="960.27" data-end="961.9">optimizing things for real users.</span> </p>
<p><span data-start="962.11" data-end="964.69">So keep it roughly the size it will be on the site.</span> <span data-start="965.86" data-end="967.28">I actually wanted to look into some of these advanced</span> <span data-start="967.28" data-end="969.95">settings in WebP because when we first built Squoosh, I</span> <span data-start="969.99" data-end="972.78">didn't know what these did. I just took the codec did and</span> <span data-start="972.82" data-end="974.58">made a UI for it.</span> <span data-start="974.87" data-end="976.58">There's a lot of it — but, I now know what they do.</span> <span data-start="977.33" data-end="978.33">I did some research.</span> <span data-start="980.08" data-end="981.75">The really interesting ones: auto adjusting the filter,</span> <span data-start="981.75" data-end="983.21">this is a good thing to do.</span> <span data-start="983.38" data-end="985.42">This really slows down the encoding time, but</span> <span data-start="987.46" data-end="989.3">it improves the visual a lot.</span> <span data-start="989.67" data-end="991.93">Now that the filter is actually a decoding filter,</span> <span data-start="993.3" data-end="994.72">it's just what it's going to do to remove that blockiness.</span> <span data-start="995.76" data-end="998.43">But it increases the encoding time because it tries to</span> <span data-start="998.43" data-end="1001.27">figure out by looking at the image what the best kind</span> <span data-start="1001.77" data-end="1003.9">of filtering is going to be.</span> </p>
<p><span data-start="1005.73" data-end="1008.48">But, yeah, it's just it's just a one bit flag or not one</span> <span data-start="1008.82" data-end="1010.57">bit. A couple of bits.</span> <span data-start="1011.15" data-end="1013.61">Three bits, I guess, if there's eight levels of filter</span> <span data-start="1013.61" data-end="1014.62">sharpness.</span> <span data-start="1014.82" data-end="1015.87">Yes, exactly.</span> <span data-start="1016.08" data-end="1017.16">I think that might should be more.</span> <span data-start="1017.91" data-end="1020.04">I think, I think it might actually go from zero to 100.</span> <span data-start="1020.12" data-end="1022.96">But so it's probably a byte. The other one</span> <span data-start="1023.42" data-end="1025.5">that I always knew, Oh, this makes a big change to the</span> <span data-start="1025.5" data-end="1027.38">image, but I don't know what it's doing. It's a spatial</span> <span data-start="1027.42" data-end="1028.38">noise shaping.</span> <span data-start="1029.09" data-end="1030.55">Now, like I said, WebP can have these 4 different</span> <span data-start="1030.55" data-end="1030.8">strategies..</span> </p>
<p><span data-start="1030.8" data-end="1031.55">Did we- did we misspell spatial?</span> <span data-start="1037.1" data-end="1038.1">\h \h
2582
02:59:26,166  — > 02:59:28,542
thing is I've actually spelled it wrong in my notes for</span> <span data-start="1046.02" data-end="1047.02">this video as well.</span> <span data-start="1048.9" data-end="1049.9">Well, that's a bug report.</span> <span data-start="1051.24" data-end="1053.36">Yeah, so anyway. So the other option is spatial noise</span> <span data-start="1053.36" data-end="1054.36">shaping.</span> <span data-start="1055.45" data-end="1057.58">And so WebP can have these different strategies for</span> <span data-start="1057.58" data-end="1060.66">different parts of the image. SNS, what that does is it</span> <span data-start="1060.83" data-end="1062.25">changes the extremity between</span> <span data-start="1064" data-end="1065.46">those different strategies.</span> <span data-start="1065.75" data-end="1068.29">So higher SNS takes bytes away from the stuff that least</span> <span data-start="1068.29" data-end="1070.88">needs it and gives it to the stuff that needs it most.</span> </p>
<p><span data-start="1070.92" data-end="1074.51">It's like Robin Hood for image compression, basically.</span> <span data-start="1075.13" data-end="1077.76">In some images, turning that up to 100 has a positive</span> <span data-start="1078.01" data-end="1081.18">result. It doesn't here, 50 is actually a pretty good,</span> <span data-start="1081.18" data-end="1082.18">pretty good for this image.</span> <span data-start="1082.35" data-end="1083.35">Can you go too high?</span> <span data-start="1083.85" data-end="1087.02">And like going higher makes the image worse again?</span> <span data-start="1087.86" data-end="1089.61">Yeah. So with this image, it does go</span> <span data-start="1091.03" data-end="1092.03">worse.</span> </p>
<p><span data-start="1093.03" data-end="1093.49">Interesting.</span> <span data-start="1093.49" data-end="1095.82">So if I, if I make it extreme here, it's giving</span> <span data-start="1096.66" data-end="1099.37">more data to the road because that's where the blockiness</span> <span data-start="1099.37" data-end="1102.5">is. But it starts to introduce like,</span> <span data-start="1102.75" data-end="1104.58">it makes the tires of the car look bad.</span> <span data-start="1105.42" data-end="1106.42">I see.</span> <span data-start="1106.58" data-end="1109.09">You start to notice that the artifacts that — you start to</span> <span data-start="1109.34" data-end="1111.21">-because it's taking data away from high frequency area,</span> <span data-start="1111.25" data-end="1112.38">giving it to low frequency.</span> </p>
<p><span data-start="1113.38" data-end="1116.63">The image of the woods that I had on before, it</span> <span data-start="1116.8" data-end="1118.93">- actually SNS of 100 works really, really well because it</span> <span data-start="1118.93" data-end="1121.26">takes lots of data away from the leaves and stuff that you</span> <span data-start="1121.26" data-end="1123.64">can't you the noise and gives it to the</span> <span data-start="1124.27" data-end="1126.14">area of the sky. So it works really well.</span> <span data-start="1127.65" data-end="1128.81">We're gonna need a JPEG as well.</span> <span data-start="1129.44" data-end="1131.15">So just for fun.</span> <span data-start="1131.9" data-end="1134.9">I'm going to make the JPEG the same size as the WebP just</span> <span data-start="1134.9" data-end="1138.07">to show the difference in quality of the compression</span> <span data-start="1138.07" data-end="1140.83">here. So I have to take — the same again — quality right</span> <span data-start="1141.24" data-end="1143.79">down til it's about forty kilobytes.</span> <span data-start="1144.83" data-end="1146.33">I'm going to do what I said not to do.</span> <span data-start="1147.08" data-end="1149.79">Okay. This looks pretty bad to my eyes right now at this</span> <span data-start="1149.79" data-end="1152.09">level. But obviously with video compression, it might not</span> <span data-start="1152.09" data-end="1153.59">be as obvious so I am going to zoom it in.</span> </p>
<p><span data-start="1156.13" data-end="1158.55">JPEG creates this horrible, blocky effect across the road.</span> <span data-start="1158.76" data-end="1160.64">And like I said, this is low frequency data.</span> <span data-start="1160.93" data-end="1162.6">So this is going to be like the circle in the sky.</span> <span data-start="1162.64" data-end="1164.02">It's a super obvious.</span> <span data-start="1164.77" data-end="1167.19">Around the yellow strip, the cut, the transition from the</span> <span data-start="1167.19" data-end="1170.23">yellow strip to the road makes it really obvious where</span> <span data-start="1170.69" data-end="1171.52">the data's lost.</span> <span data-start="1171.52" data-end="1172.65">Yeah, you can see the blockiness there.</span> <span data-start="1172.77" data-end="1175.32">And this is where the filtering that WebP does is</span> <span data-start="1176.86" data-end="1179.11">much better. So, yeah, I just have to increase the size of</span> <span data-start="1179.11" data-end="1181.91">the jpeg until that horrible blockiness just goes away.</span> <span data-start="1182.33" data-end="1185.24">And at that point it's like double the size -</span> <span data-start="1186.16" data-end="1187.58">over double the size — of the WebP.</span> <span data-start="1189.67" data-end="1191.38">There are things you can do to improve it if you wanna</span> <span data-start="1191.42" data-end="1192.42">spend the time.</span> </p>
<p><span data-start="1193.29" data-end="1194.34">More advanced settings.</span> <span data-start="1194.59" data-end="1196.59">The most interesting advanced setting here I think is the</span> <span data-start="1196.59" data-end="1197.59">chroma subsampling.</span> <span data-start="1198.09" data-end="1198.42">Yeah.</span> <span data-start="1198.42" data-end="1199.68">This is what we discussed before.</span> <span data-start="1199.72" data-end="1202.64">Right. This is just reducing that color data, especially if</span> <span data-start="1202.68" data-end="1204.6">you're on a high density screen. You can get away with</span> <span data-start="1204.6" data-end="1207.06">less. In fact, most of time I would say you can just turn</span> <span data-start="1207.06" data-end="1210.06">it up to four. We saw earlier that this particular</span> <span data-start="1210.06" data-end="1213.15">picture is kind of sensitive to color reduction.</span> </p>
<p><span data-start="1213.61" data-end="1215.48">So three was it was a good one, but it knocked 10KB off so</span> <span data-start="1217.28" data-end="1218.28">that's worth having.</span> <span data-start="1218.57" data-end="1221.82">I also often combine it with the separate chroma quality</span> <span data-start="1221.82" data-end="1224.91">so that you can basically introduce the blockiness into</span> <span data-start="1224.91" data-end="1227.54">the colors but not into the brightness, which is much</span> <span data-start="1227.91" data-end="1229.16">less [inaudible].</span> </p>
<p><span data-start="1229.16" data-end="1231.12">Interesting. I've never had success with that.</span> <span data-start="1231.17" data-end="1234.25">I've always — I've tried that and I've never — I've</span> <span data-start="1234.25" data-end="1235.59">always been unhappy with the results.</span> <span data-start="1235.59" data-end="1238.13">But yes, like mileage may vary.</span> <span data-start="1238.46" data-end="1241.43">The option is there. So people can play around with</span> <span data-start="1241.43" data-end="1242.43">that.</span> <span data-start="1242.93" data-end="1243.93">Absolutely.</span> <span data-start="1244.64" data-end="1247.43">But, yeah, I think it's worth in this case, to serve both</span> <span data-start="1247.43" data-end="1249.6">the WebP and the JPEG because it's like half the size for</span> <span data-start="1249.6" data-end="1250.6">the browsers that support it.</span> <span data-start="1251.02" data-end="1253.02">But that's it. That's everything I really had to say about</span> <span data-start="1253.98" data-end="1254.98">lossy images.</span> </p>
<p><span data-start="1255.23" data-end="1257.98">Well, you said you had major research about the options.</span> <span data-start="1258.32" data-end="1260.44">What exactly is pointless spec compliance?</span> <span data-start="1262.15" data-end="1264.78">Pointless spec complaince removes the</span> <span data-start="1265.58" data-end="1268.66">progressive encoding and</span> <span data-start="1268.66" data-end="1270.45">some of the other things that according to a strict</span> <span data-start="1270.45" data-end="1273.37">interpretation of the JPEG spec, it's not</span> <span data-start="1273.87" data-end="1276">supposed to do that, but everyone supports it and it's good</span> <span data-start="1276" data-end="1277">for file size.</span> </p>
<p><span data-start="1277.21" data-end="1279.17">I thought I would totally put you on the</span> <span data-start="1280.21" data-end="1281.76">spot, but you actually know the answer. Well done.</span> <span data-start="1282.84" data-end="1284.76">Well I didn't research the JPEG, but that was one of the</span> <span data-start="1284.8" data-end="1287.43">ones I knew from looking into the encoder there.</span> <span data-start="1288.64" data-end="1291.23">So lossless — completely different world.</span> <span data-start="1291.73" data-end="1294.56">A lossless image describes pixels one at a time</span> <span data-start="1294.73" data-end="1296.9">from top to bottom, left to right.</span> <span data-start="1297.69" data-end="1300.36">But rather than describe each color from scratch,</span> <span data-start="1300.69" data-end="1303.65">it will use some of the surrounding pixels to make</span> <span data-start="1303.65" data-end="1306.03">a prediction and then it just encodes the difference.</span> </p>
<p><span data-start="1306.66" data-end="1307.91">There's a number of strategies that it can use.</span> <span data-start="1307.91" data-end="1309.74">It can look at the pixel to the left, it can look at the</span> <span data-start="1309.74" data-end="1312.71">pixel above. It can use an average of</span> <span data-start="1312.79" data-end="1314.12">some of those pixels.</span> <span data-start="1315.67" data-end="1318.75">But here's the gotcha. It can't change the strategy for</span> <span data-start="1318.75" data-end="1320.84">every pixel because that would just add too much data.</span> <span data-start="1321.38" data-end="1324.01">Instead, it has to stick with a particular strategy</span> <span data-start="1324.43" data-end="1326.05">until it decides to change strategy.</span> <span data-start="1326.14" data-end="1327.72">Now, PNG can only change strategy</span> <span data-start="1329.26" data-end="1332.27">at the start of a line. WebP can</span> <span data-start="1332.35" data-end="1335.35">define 2D blocks of different strategies.</span> </p>
<p><span data-start="1335.69" data-end="1338.44">But this is why lossless compressers can be really slow,</span> <span data-start="1338.65" data-end="1340.82">because it's just brute force going through all of these</span> <span data-start="1340.82" data-end="1342.69">different strategies to figure out which one is best.</span> <span data-start="1344.57" data-end="1346.36">Like trying all the combinations, but it means this</span> <span data-start="1346.41" data-end="1347.45">compression works really well.</span> </p>
<p><span data-start="1347.74" data-end="1350.24">If the pixel next to it is exactly the same or the pixel</span> <span data-start="1350.24" data-end="1352.7">above is exactly the same, because there's no difference,</span> <span data-start="1352.7" data-end="1354.66">then really easy to compress.</span> <span data-start="1355.21" data-end="1357.29">And it's why lossless format struggle with photo data</span> <span data-start="1357.46" data-end="1359.29">because there's lots of organically changing color.</span> </p>
<p><span data-start="1361" data-end="1363.3">Oh, one more trick that losless things have.</span> <span data-start="1364.01" data-end="1365.88">If there's 256 colors or less, it just</span> <span data-start="1367.05" data-end="1368.89">sticks those in a table and it can reference them by</span> <span data-start="1368.89" data-end="1369.51">number.</span> <span data-start="1369.51" data-end="1371.97">So rather than every time describing the red, green, blue</span> <span data-start="1371.97" data-end="1375.02">and alpha, it just says, its color number five, everyone.</span> <span data-start="1375.1" data-end="1376.52">There it is, pop that in there.</span> <span data-start="1377.19" data-end="1378.44">And that compresses really, really well.</span> <span data-start="1378.69" data-end="1380.86">So difference between the formats then.</span> <span data-start="1381.57" data-end="1384.61">WebP not many people know about the lossless</span> <span data-start="1384.74" data-end="1387.03">WebP format. It's like a completely different codec.</span> <span data-start="1387.86" data-end="1389.57">In fact, it is a completely different codec.</span> <span data-start="1390.32" data-end="1392.49">The only relation between the two is when you do lossy WebP</span> <span data-start="1392.83" data-end="1395.62">with an alpha channel. It's using the lossless format for</span> <span data-start="1395.75" data-end="1397.96">the Alpha Channel. Pointless fact for you all.</span> <span data-start="1398.58" data-end="1399.58">Oh, that's good to know.</span> </p>
<p><span data-start="1399.88" data-end="1401.75">Yeah, it is — it's just better.</span> <span data-start="1401.75" data-end="1403.92">It's got more strategies, it's got the 2D thing going on.</span> <span data-start="1403.92" data-end="1404.92">It compresses better.</span> <span data-start="1406.3" data-end="1409.47">But you do need the PNG for Safari and</span> <span data-start="1409.55" data-end="1411.18">that's all we talked about. And just never use GIF.</span> <span data-start="1411.35" data-end="1412.81">Just don't. Stop it, please.</span> <span data-start="1413.31" data-end="1414.64">Never use it. It's just — it's bad at everything.</span> <span data-start="1414.64" data-end="1417.02">It's just bad.</span> <span data-start="1417.89" data-end="1420.15">So stop using GIF for everything.</span> <span data-start="1421.61" data-end="1422.82">But let's put this into practice.</span> <span data-start="1424.07" data-end="1427.15">Back in Squoosh. This time I'm going to use something with</span> <span data-start="1427.4" data-end="1428.4">a lot of flat color.</span> <span data-start="1429.41" data-end="1431.91">And I say thanks to Stephen Waller, who donated me some of</span> <span data-start="1431.91" data-end="1433.16">his artwork to use here.</span> <span data-start="1433.7" data-end="1435.41">He's an artist I used to work with.</span> </p>
<p><span data-start="1435.49" data-end="1437.46">He makes these wonderful drawings.</span> <span data-start="1437.75" data-end="1439.87">Apparently, these are his teammates that he worked with at</span> <span data-start="1439.87" data-end="1442.84">the time. I didn't ask him about the bear, but</span> <span data-start="1443.04" data-end="1444.04">fair enough.</span> <span data-start="1446.05" data-end="1447.72">I would say the first thing to do here — same as before -</span> <span data-start="1448.22" data-end="1450.97">zoom it out. Like, keep it the same size as it will appear</span> <span data-start="1450.97" data-end="1451.97">on the site.</span> <span data-start="1452.76" data-end="1454.64">So the kind of scaling that you would actually use to use</span> <span data-start="1454.97" data-end="1456.6">the high density devices.</span> </p>
<p><span data-start="1457.56" data-end="1460.6">And now I'm just gonna go to use WebP because it's</span> <span data-start="1460.6" data-end="1462.52">the best, I'm gonna pick Lossless.</span> <span data-start="1464.11" data-end="1465.65">Yep. Completely different codec, whatever.</span> <span data-start="1466.11" data-end="1467.9">Very few people know about it, but it's really good.</span> </p>
<p><span data-start="1468.03" data-end="1469.03">We're straight down to 43K.</span> <span data-start="1470.53" data-end="1472.82">This is a slight loss option which I found very</span> <span data-start="1473.57" data-end="1474.78">funny. It's great isn't it.</span> <span data-start="1476.24" data-end="1478.58">What it will do is change the pixels to try and make them</span> <span data-start="1478.58" data-end="1479.58">more predictable.</span> <span data-start="1481.08" data-end="1483.96">I actually don't like the visual effect it introduces, but,</span> <span data-start="1484.13" data-end="1485.54">so I don't really use it.</span> <span data-start="1485.63" data-end="1487.3">But your mileage may vary.</span> <span data-start="1487.42" data-end="1488.67">It's fun to play with.</span> </p>
<p><span data-start="1489.88" data-end="1491.72">But remember when I said earlier that these formats do</span> <span data-start="1491.72" data-end="1493.8">really well with 256 colors or less?</span> <span data-start="1494.55" data-end="1496.31">We're going to do that. We're going to reduce the palette</span> <span data-start="1496.31" data-end="1497.31">down.</span> <span data-start="1498.02" data-end="1500.02">It doesn't look like this image has a lot of colors, but</span> <span data-start="1500.02" data-end="1502.65">because of the anti-aliasing around all of the curves, it's</span> <span data-start="1502.65" data-end="1505.06">got lots of like slight variations, blends of one</span> <span data-start="1505.73" data-end="1506.73">color to another.</span> </p>
<p><span data-start="1507.94" data-end="1510.44">I've also changed the codec to browser PNG, and that's just</span> <span data-start="1510.44" data-end="1511.95">cause it's really fast to compress.</span> <span data-start="1511.95" data-end="1513.95">So it's going to be — I'm going to get a quick response</span> <span data-start="1513.99" data-end="1515.41">when I'm changing the number of colors.</span> <span data-start="1515.99" data-end="1517.24">I'm also going to turn off dithering.</span> <span data-start="1519.16" data-end="1521.87">If you reduce the number of colors of something, you can</span> <span data-start="1521.87" data-end="1523.96">get this banding effect that you can see here.</span> <span data-start="1524.04" data-end="1527.21">Dithering like tries to remove the banding by</span> <span data-start="1527.25" data-end="1530.26">using like pointillism or like these</span> <span data-start="1530.26" data-end="1531.84">dots to kind of recreate the shading.</span> <span data-start="1532.26" data-end="1534.47">It's super effective, but lossless deals well</span> <span data-start="1535.47" data-end="1538.06">with flat color so it will increase the file size, so</span> </p>
<p><span data-start="1538.43" data-end="1540.35">I would avoid it unless you really need</span> <span data-start="1541.48" data-end="1542.48">it.</span> <span data-start="1543.73" data-end="1546.81">I have compressed a couple of, like, photographs to</span> <span data-start="1546.81" data-end="1549.53">PNG with dithering and it'll actually look -</span> <span data-start="1550.23" data-end="1552.44">if you zoom out and have it's small enough — it will</span> <span data-start="1552.44" data-end="1554.61">actually look almost the same.</span> <span data-start="1554.74" data-end="1556.41">Often it's imperceptible.</span> <span data-start="1557.12" data-end="1558.99">Yeah. And there are some times that you need to do that.</span> <span data-start="1560.24" data-end="1562.54">So now the same as before. I'm just going to reduce the</span> <span data-start="1562.54" data-end="1565.54">colors as much as possible until it looks</span> <span data-start="1565.54" data-end="1566.54">bad.</span> <span data-start="1567.17" data-end="1569.21">And this is why this one the reason we built Squoosh,</span> <span data-start="1569.46" data-end="1571.51">because it's like, it's so much</span> <span data-start="1572.55" data-end="1575.09">nicer to do this with a visual response than getting</span> <span data-start="1575.55" data-end="1577.72">like a computer to try and figure it out because it's not</span> <span data-start="1577.72" data-end="1578.72">going to do it as well.</span> </p>
<p><span data-start="1579.01" data-end="1582.22">I'd say important advice — same as before — don't zoom in</span> <span data-start="1582.52" data-end="1583.85">because it will look bad.</span> <span data-start="1584.39" data-end="1586.23">You know that you can see the harsh edge here.</span> <span data-start="1587.52" data-end="1589.9">But zoomed out, you barely notice it.</span> <span data-start="1589.94" data-end="1592.4">So it's fine. And that's how users are going to see it.</span> </p>
<p><span data-start="1592.57" data-end="1593.57">So there we go.</span> <span data-start="1593.9" data-end="1595.74">So we've been able to like, reduce the colors like down to</span> <span data-start="1595.91" data-end="1598.78">68. And so now if we're gonna go</span> <span data-start="1599.07" data-end="1600.08">to switch back to</span> <span data-start="1602.08" data-end="1604.58">WebP, turn the effort up, let it use all of its iterations</span> <span data-start="1604.58" data-end="1605.62">to figure out the compression.</span> <span data-start="1606.21" data-end="1607.67">And like, boom, there we go.</span> </p>
<p><span data-start="1607.71" data-end="1608.71">It's like 13K.</span> <span data-start="1609.5" data-end="1610.5">It's amazing.</span> <span data-start="1611.5" data-end="1614.17">Isn't it? like it's incredible how much that saves.</span> <span data-start="1616.51" data-end="1617.84">For Safari, we need the PNG.</span> <span data-start="1618.43" data-end="1621.47">PNG compressors are really varied.</span> <span data-start="1622.01" data-end="1624.18">So we use OxiPNG, which is a pretty good one.</span> <span data-start="1624.98" data-end="1627.9">And that will take it down to what, 17K?</span> <span data-start="1627.9" data-end="1628.6">It's a close second, pretty good.</span> <span data-start="1630.31" data-end="1631.61">It's close.</span> <span data-start="1631.98" data-end="1633.86">And I would say I would give a shout out to ImageOptim</span> <span data-start="1634.74" data-end="1637.4">which ships with OxiPNG, but also lots of other PNG</span> <span data-start="1637.74" data-end="1639.95">compressors that we would like to add to Squoosh at some</span> <span data-start="1639.95" data-end="1640.95">point. But we haven't yet.</span> </p>
<p><span data-start="1641.91" data-end="1643.58">And it brings the file size down even more.</span> <span data-start="1643.95" data-end="1647.33">In fact, it's only 3K off the</span> <span data-start="1647.41" data-end="1649.29">WebP. So in this case, I would probably not bother.</span> <span data-start="1649.29" data-end="1652">Unless I had like a load of images on the page, and that</span> <span data-start="1652.25" data-end="1654.09">difference adds up, I would say just serve the PNG.</span> </p>
<p><span data-start="1654.09" data-end="1657.05">It's fine, 3k is not worth the complexity.</span> <span data-start="1657.76" data-end="1660.18">So, yeah, rather than think of a compression format for a</span> <span data-start="1660.18" data-end="1661.6">particular kind of image.</span> <span data-start="1661.8" data-end="1664.18">Like my take away is like think about how the compression</span> <span data-start="1664.22" data-end="1667.27">actually works and use that as your</span> <span data-start="1667.27" data-end="1669.44">first guess. But as you said earlier, it's always worth</span> <span data-start="1669.44" data-end="1671.27">trying it in something else. So I'm going to look at a</span> <span data-start="1671.27" data-end="1673.11">couple of edge cases to finish up on.</span> <span data-start="1674.57" data-end="1676.07">Look at this. Look at this.</span> <span data-start="1676.19" data-end="1677.44">This is beautiful.</span> <span data-start="1678.11" data-end="1679.7">This is SVG.</span> <span data-start="1680.61" data-end="1682.87">I was going to say, it looks like one of these things that</span> <span data-start="1682.91" data-end="1685.83">the CSS artists build was just like a billion divs</span> <span data-start="1686.37" data-end="1687.91">and gradients and shadows.</span> <span data-start="1687.96" data-end="1690.92">And then a photorealistic thing turns out to just be</span> <span data-start="1691" data-end="1692">CSS.</span> </p>
<p><span data-start="1692.42" data-end="1694.63">It's pretty much what is happening here; but with SVG.</span> <span data-start="1695.05" data-end="1696.42">I think this was manually created.</span> <span data-start="1696.55" data-end="1699.63">Yeah. Very similar. If I minify it in SVG OMG, which</span> <span data-start="1699.63" data-end="1702.43">is a SVG compression GUI I made, but</span> <span data-start="1702.72" data-end="1704.89">it's based on SVGO, which is a node</span> <span data-start="1705.72" data-end="1708.06">app. I get it down to 37K.</span> <span data-start="1710.02" data-end="1712.98">But this is so complicated and uses so many filters, like</span> <span data-start="1713.02" data-end="1714.73">look at the jank there on the resizing.</span> <span data-start="1714.77" data-end="1717.69">And this is on a high end MacBook. It is taking a ton of</span> <span data-start="1717.69" data-end="1719.32">CPU to render that image.</span> <span data-start="1721.16" data-end="1723.53">So over in Squoosh, lossy WebP</span> <span data-start="1724.24" data-end="1726.58">does a really good job of this like 53K.</span> </p>
<p><span data-start="1726.62" data-end="1727.91">It's actually bigger than the SVG.</span> <span data-start="1728.75" data-end="1732.25">But the saving in CPU makes this a better decision.</span> <span data-start="1732.92" data-end="1734.5">And that's actually interesting because that's something</span> <span data-start="1734.5" data-end="1737.3">that Squoosh doesn't really allow you</span> <span data-start="1737.67" data-end="1738.67">to quantify, right?</span> <span data-start="1739.84" data-end="1740.84">The saving in the CPU.</span> <span data-start="1741.97" data-end="1743.34">Yes, exactly. Yeah.</span> </p>
<p><span data-start="1743.51" data-end="1745.3">It'd be nice if we could find a way to do that somehow.</span> <span data-start="1746.01" data-end="1748.35">But yeah, if it's struggling in</span> <span data-start="1748.97" data-end="1751.48">- with this image, you notice how slow it loads and</span> <span data-start="1751.98" data-end="1754.9">you notice in SVG OMG how slow it is to resize, so</span> <span data-start="1755.4" data-end="1756.4">that's a good signal.</span> <span data-start="1757.98" data-end="1760.24">The PNG equivalent — because can't use JPEG for this</span> <span data-start="1760.24" data-end="1763.16">because it's got alpha transparency — the PNG is 86K.</span> <span data-start="1764.66" data-end="1767.53">And I've had to reduce the colors and that introduced a lot</span> <span data-start="1767.53" data-end="1769.29">of banding, so I had to introduce dithering.</span> </p>
<p><span data-start="1769.33" data-end="1770.75">And that's actually noticeable.</span> <span data-start="1771.04" data-end="1772.33">You can see the dots.</span> <span data-start="1772.46" data-end="1775.04">It's not great, but without the palette reduction, it's</span> <span data-start="1775.04" data-end="1778.13">300K. So in this case, you would kind of say,</span> <span data-start="1778.25" data-end="1780.8">I'm sorry, Safari users, you don't get quite as nice</span> <span data-start="1781.38" data-end="1782.51">an image, you know.</span> <span data-start="1782.67" data-end="1785.8">Yeah, but it's worth it for the file size.</span> </p>
<p><span data-start="1785.97" data-end="1788.64">Although I guess you could also serve the SVG because — I</span> <span data-start="1788.64" data-end="1791.98">mean the picture element, you specify the sources</span> <span data-start="1792.02" data-end="1793.31">in order of priority.</span> <span data-start="1793.64" data-end="1796.61">So you could put the WebP first, and could put the SVG</span> <span data-start="1796.94" data-end="1797.94">second?</span> <span data-start="1798.11" data-end="1800.82">Yeah. You could decide like to say, well you know, Safari</span> <span data-start="1800.82" data-end="1803.86">users are likely to be on a high end device, so the</span> </p>
<p><span data-start="1803.99" data-end="1805.32">SVG is less bad maybe.</span> <span data-start="1805.57" data-end="1807.32">But it's still going to cause jank to other things on the</span> <span data-start="1807.32" data-end="1810.33">page. You know, it is like -</span> <span data-start="1810.33" data-end="1812.83">on a high end MacBook it's bad. But yes, you could make</span> <span data-start="1812.83" data-end="1813.66">that judgment call.</span> <span data-start="1813.66" data-end="1816.71">You can say the jank is better than the 300K or the</span> <span data-start="1816.71" data-end="1817.71">banding or whatever.</span> <span data-start="1818.42" data-end="1820">One more example I'll leave you with.</span> <span data-start="1820.88" data-end="1822.46">This is another one of Stephen's drawings.</span> <span data-start="1823.59" data-end="1825.88">It has a lot of flat color. So my instincts for this would</span> <span data-start="1825.88" data-end="1827.47">be to go for a lossless format.</span> <span data-start="1828.01" data-end="1830.22">But there's also a lot of shadows, a lot of gradients as</span> <span data-start="1830.22" data-end="1832.22">well. So, again, lossy WebP does a really</span> <span data-start="1833.31" data-end="1836.4">good job of this. Like it takes it down to 28K.</span> </p>
<p><span data-start="1837.94" data-end="1840.86">If you go for a lossless format, even with the palette</span> <span data-start="1841.07" data-end="1844.11">reduction, it's 118K and you actually get a lap banding</span> <span data-start="1844.24" data-end="1845.95">with it. So, yeah, it's like tools,</span> <span data-start="1847.32" data-end="1849.03">not rules. That's my take away from this.</span> <span data-start="1849.28" data-end="1851.62">Like think about the codecs in terms of what they are good</span> <span data-start="1851.62" data-end="1853.75">at. Think about how they work.</span> <span data-start="1854.33" data-end="1857.5">And with that, go and make your images smaller.</span> <span data-start="1858.08" data-end="1860.17">Please, please make her images smaller.</span> <span data-start="1860.38" data-end="1862.8">I've actually enjoyed this. This has been like — should we</span> <span data-start="1862.8" data-end="1864.13">do some more 203s like this?</span> <span data-start="1864.3" data-end="1865.3">Should we do some remote 203s?</span> <span data-start="1865.72" data-end="1867.05">I don't know when we're gonna get back to the office.</span> </p>
<p><span data-start="1867.13" data-end="1868.8">I was planning to. Absolutely.</span> <span data-start="1869.43" data-end="1871.26">Well, we've got the equipment, so let's do it.</span> <span data-start="1872.39" data-end="1873.56">Happy. Next time.</span> <span data-start="1874.14" data-end="1875.14">Happy next time.</span> </p>
</section>

<!-- div#container ends -->
</div>

<img alt="The End" id="fin" src="../images/fin.jpg">

<script>
/*eslint-disable */
function googleTranslateElementInit() {
  new google.translate.TranslateElement({pageLanguage: 'en',
    layout: google.translate.TranslateElement.InlineLayout.SIMPLE
    }, 'google-translate');
}
/* eslint-enable */
</script>

<script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<script src="../js/main.js"></script>

</body>

</html>
