<!DOCTYPE html>

<!--
Copyright 2019 Google LLC

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

  https://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="author" content="//google.com">
  <meta name="description" content="web.dev LIVE video transcript">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>vsMJiNtQWvw</title>
  <link rel="stylesheet" href="../css/main.css">
</head>

<body>

<iframe id="youtube" src="https://www.youtube.com/embed/vsMJiNtQWvw?enablejsapi=1"></iframe>

<div id="container">

<div id="options">
  <div id="google-translate"></div>
  <div>
    <input type="checkbox" id="videoSticky" checked>
    <label for="videoSticky">Video position sticky</label>
  </div>
  <div>
    <input type="checkbox" id="captionScroll" checked>
    <label for="captionScroll">Keep current caption visible</label>
  </div>
</div>

<section>
<p><span data-start="13.28" data-end="15.16">If you are building website today</span> <span data-start="15.16" data-end="18.46">chances are, you are using some sort of build tools</span> <span data-start="18.46" data-end="23.12">[Mariko]  all right so one question when you are starting a new project or</span> <span data-start="23.12" data-end="28.54">you are giving brand new repo and then like, "Hey Surma, please start this project"</span> <span data-start="28.54" data-end="31.2">where do you start what tools do you choose like tell me</span> <span data-start="31.21" data-end="33.66">about your, like, setup.</span> <span data-start="33.66" data-end="37.04">[Surma] ah, this has evolved so much over time</span> <span data-start="37.04" data-end="39.62">[Jason] I I take a long time to decide</span> <span data-start="39.62" data-end="41.62">and I usually start out without a bundler</span> <span data-start="41.62" data-end="43.8">[Adam] my preferred starting place is</span> </p>
<p><span data-start="43.8" data-end="48.18">I just want to write latest JS latest CSS and the rest of it is out</span> <span data-start="48.18" data-end="50.12">of my way until I'm gonna solve it.</span> <span data-start="50.12" data-end="52.98">It really depends on what the project is</span> <span data-start="52.98" data-end="59.56">I've been building a lot of static sites lately and 11ty is a recently I guess a</span> <span data-start="59.579" data-end="63">relatively new tool for static site generation and I've been converting some</span> <span data-start="63" data-end="69.78">Jekyll sites into that and it's just felt so nice and not super robust which</span> <span data-start="69.78" data-end="72.84">is what you sort of need for a static site,  but then if I am building a more</span> <span data-start="72.84" data-end="77.759">dynamic project I'll either go with like NextJS or Gatsby if I want like react</span> <span data-start="77.759" data-end="81.57">with a static site because they like how it parses out to just HTML CSS and</span> <span data-start="81.57" data-end="86.08">JavaScript but there's a thousand tools and it really just depends</span> <span data-start="86.08" data-end="87.66">that's the answer it depends</span> <span data-start="87.66" data-end="91.04">So I was a webpack user and I use webpack because at the</span> <span data-start="91.04" data-end="94.18">time it was the only one that supported  code splitting</span> <span data-start="94.18" data-end="97.84">because like I knew I just needed to add this tag in the head</span> <span data-start="97.84" data-end="104.08">but like the HTML plug-in had went  no this is mine now you may not touch</span> <span data-start="104.08" data-end="106.74">and then other things like  in the earlier days of Service Worker</span> </p>
<p><span data-start="106.74" data-end="109.68">I wanted to.. I just wanted like a list of the output files</span> <span data-start="109.68" data-end="112.92">I want like you know let me know what the the hash is going to be for these files</span> <span data-start="112.92" data-end="118.02">but reading the webpack plug-in Docs I just, I was getting so frustrated</span> <span data-start="118.02" data-end="119.08">I couldn't figure it out</span> </p>
<p><span data-start="119.08" data-end="122.12">I used to use gulp or Grunt a lot</span> <span data-start="122.12" data-end="126.36">because at least I understood what's happening and then with webpack</span> <span data-start="126.36" data-end="129.36">I really didn't understand what's happening</span> <span data-start="129.36" data-end="132.48">Now over time I have kind of</span> <span data-start="132.48" data-end="134.4">fallen in love with Rollup</span> </p>
<p><span data-start="134.4" data-end="137.66">So I have my own build system that I've been managing</span> <span data-start="137.66" data-end="141.04">it's probably my sixth build system I've made</span> <span data-start="141.04" data-end="142.5">if you go look at my Github history, I have</span> <span data-start="142.52" data-end="145.9">a Grunt one, I have a Make one, I have gulp one</span> <span data-start="145.9" data-end="148.76">I I've been following all these build tools for a long time</span> <span data-start="148.76" data-end="152.26">Here's how I feel about Web projects is complexity is inevitable</span> <span data-start="152.26" data-end="154.18">There's no way to get around it and</span> <span data-start="154.18" data-end="157.63">you're either injecting complexity from the beginning and making it worse</span> <span data-start="157.63" data-end="160.78">or you're waiting until you're complexity confronts you.</span> <span data-start="161.3" data-end="166.14">[Marko] Yes even if you start simple complexity is inevitable</span> <span data-start="166.14" data-end="170">Idea of making website in principle is straightforward</span> <span data-start="170" data-end="173.98">You make HTML document add style to it</span> <span data-start="173.98" data-end="176.7">and add some functionality to it too</span> <span data-start="176.7" data-end="180.76">but in practice web development gets a lot more complex</span> <span data-start="180.76" data-end="185.22">Your application code may depend on outside libraries or different modules</span> <span data-start="185.23" data-end="188.1">you might be importing web fonts</span> <span data-start="188.1" data-end="190.45">or you might be pre-rendering a portion of a</span> <span data-start="190.45" data-end="194.59">page as a static site so that it can get delivered faster to the users</span> <span data-start="194.59" data-end="200.48">and chances are you're probably using build tools to manage all of these complexities</span> <span data-start="200.48" data-end="205.24">but because tools expects certain set up sometimes seemingly</span> <span data-start="205.24" data-end="211.45">simple tasks like add a line to HTML gets harder to accomplish there are many</span> <span data-start="211.45" data-end="216.3">challenges like this in web development so let's look at how we manage JavaScript</span> </p>
<p><span data-start="216.3" data-end="220.66">In the past we've written everything in independent file or</span> <span data-start="220.66" data-end="227.04">different script tags and carefully combine them or add it to HTML by ourselves</span> <span data-start="227.04" data-end="231.24">The way we write JavaScript we used to like have this like massive file</span> <span data-start="231.24" data-end="236.36">the humans needed to know which one goes first and which one goes after</span> <span data-start="236.36" data-end="240.58">Yeah and even like you're you're making me remember where I started with bundling</span> <span data-start="240.58" data-end="244.99">which was a PHP script that concatenated all my JavaScript files together which</span> <span data-start="244.99" data-end="248.96">now feels wrong but at the time felt very powerful</span> <span data-start="248.96" data-end="251.36">[Mariko] but now we have modules</span> <span data-start="251.36" data-end="256.72">which means dependency of each modules are specified in the code which means a</span> <span data-start="256.72" data-end="261.86">build tool can analyze a file and create bundle for us</span> <span data-start="261.86" data-end="264.72">even better, some tool like webpack</span> <span data-start="264.72" data-end="268.28">analyze which part of the code is actually being used</span> <span data-start="268.28" data-end="271.8">and extracted it to make smaller bundles</span> <span data-start="271.8" data-end="274.16">[Mariko] when we started writing JavaScript this way</span> </p>
<p><span data-start="274.16" data-end="277.7">I feel like webpack came in the scene as a tool of choice</span> <span data-start="277.7" data-end="283.44">with you know things that has a lot of bells and whistles and do things</span> <span data-start="283.44" data-end="288.419">like tree shaking and scope hosting so could you explain how webpack handles</span> <span data-start="288.419" data-end="290.74">this module javascript field</span> <span data-start="290.74" data-end="296.12">[Jason] Yeah so webpack supports like a huge number of module formats</span> <span data-start="296.12" data-end="302.6">like some of the common ones obviously ES modules,  CommonJS, everybody knows about</span> <span data-start="302.6" data-end="305.72">but it actually supports parsing and understanding the</span> <span data-start="305.73" data-end="313.89">structure of SystemJS modules and AMD modules and even Wasm imports and so</span> <span data-start="313.89" data-end="319.11">it takes all that information and in its in-memory graph representation</span> <span data-start="319.11" data-end="324.69">it attaches that and can use it to you know if you only imported one thing from a</span> <span data-start="324.69" data-end="330.18">module it can essentially delete the export from that module that you didn't</span> <span data-start="330.18" data-end="335.28">use and that way that code path won't end up in your bundle and when you take</span> <span data-start="335.28" data-end="339.93">that your fragment it out you know maybe that export was using another import</span> <span data-start="339.93" data-end="344.37">from another module and now that's unused you can see how flowing that</span> <span data-start="344.37" data-end="348.98">information through the graph eventually you could end up removing a fair bit of code</span> </p>
<p><span data-start="348.98" data-end="354.78">So webpack doesn't actually convert modules to an internal source format it</span> <span data-start="354.78" data-end="360.36">is more focused on understanding them and their structure as they exist on disk</span> <span data-start="360.36" data-end="365.28">[Mariko] Our JavaScript file does not have to be a single file so tools like Rollup</span> <span data-start="365.28" data-end="368.68">will split them up into smaller chunks</span> <span data-start="368.68" data-end="372.5">Can you explain why Rollup is really good at it?</span> <span data-start="372.5" data-end="379.08">[Jake] Yeah so webpack has its own loader and so does Parcel</span> <span data-start="379.08" data-end="383.28">whereas Rollup by default is ECMAScript modules</span> <span data-start="383.28" data-end="386">like that's where it lives it lives in that world so the</span> <span data-start="386.01" data-end="389.3">output it generates is like way simpler than the other tools</span> <span data-start="389.3" data-end="392.76">in terms of code splitting Rollup's implementation is very</span> <span data-start="392.76" data-end="395.56">pure, I would say</span> </p>
<p><span data-start="395.56" data-end="400.38">It will create the smallest number of chunks that it can</span> <span data-start="400.38" data-end="404.64">but it will create a small chunk</span> <span data-start="404.64" data-end="406.36">like maybe your chunk just containing one function</span> <span data-start="406.36" data-end="408.56">if that's the only bit shared by two entry points</span> <span data-start="408.56" data-end="412.86">and that's something that webpack and Parcel don't do</span> <span data-start="412.86" data-end="416.76">They will duplicate that module in both of their bundles</span> <span data-start="416.76" data-end="420.84">whereas Rollup will always just create a separate chunk</span> <span data-start="420.84" data-end="423.1">it's very pure it'll never duplicate code</span> <span data-start="423.1" data-end="426.5">[Mariko] and different script runs in different thread</span> <span data-start="426.5" data-end="430.82">ideally common dependencies are exported as one chunk</span> <span data-start="430.82" data-end="435.22">but some tools doesn't understand it so it creates duplicate</span> <span data-start="435.22" data-end="438.62">[Mariko] What was interesting to me was that the Parcel supports</span> <span data-start="438.62" data-end="444.54">worker and main thread splitting out of the box Is there any backstory for that</span> <span data-start="444.54" data-end="450.48">[Surma] There is and I think I can take a little, tiny bit of credit for Parcel supporting that</span> <span data-start="450.48" data-end="454.08">because it was I think like February 2018</span> <span data-start="454.08" data-end="459.34">you me and some others were working on Squoosh and Squoosh made heavy use of</span> </p>
<p><span data-start="459.34" data-end="463.12">WebAssembly and put the WebAssembly in the Web Worker and then</span> <span data-start="463.12" data-end="465.22">use Comlink to use those Web Workers</span> <span data-start="465.22" data-end="469.2">and we built Squoosh using webpack  and we figured out over time</span> <span data-start="469.2" data-end="473.66">but actually the way webpack built that project</span> <span data-start="473.66" data-end="477.86">it put a copy of Comlink into the worker  and into the main thread</span> <span data-start="477.86" data-end="480.6">so the user ended up loading that code twice</span> <span data-start="480.6" data-end="484.4">now comm leak isn't that big so it's not that big of a deal but with</span> <span data-start="484.41" data-end="489.26">bigger dependencies that could actually become a significant problem and so I</span> <span data-start="489.26" data-end="494.88">filed a fairly long bug on webpack like with a graph and everything explaining</span> <span data-start="494.88" data-end="499.56">why that should change and it hasn't been fixed yet but it's been discussed a</span> <span data-start="499.56" data-end="502.919">lot and I think Sean Larkin told me that webpack 5 will finally be able to</span> <span data-start="502.92" data-end="507.48">address a problem but shortly after I opened that bug on webpack</span> </p>
<p><span data-start="507.48" data-end="509.9">Devon Govett who is the maintainer of Parcel</span> <span data-start="509.9" data-end="514.42">actually opened an issue himself on Parcel for himself</span> <span data-start="514.42" data-end="518.88">saying "I think we can do this I think Parcel can fix this problem" and so</span> <span data-start="518.88" data-end="522.4">I don't know how long it took him but I guess a couple months later the bug was closed</span> <span data-start="522.4" data-end="527">and suddenly Parcel now supported this  code splitting across worker boundaries</span> <span data-start="527" data-end="529.94">and that was just really really cool to see</span> <span data-start="529.94" data-end="535.02">[Mariko] Beyond making JavaScript bundles  build tools help us manage assets too</span> <span data-start="535.02" data-end="539.02">sometimes separately and sometimes through JavaScript</span> </p>
<p><span data-start="539.02" data-end="543.46">So I think that as CSS has evolved  the tooling around it has grown as well</span> <span data-start="543.56" data-end="547.62">and I think the first like really big instance of CSS tooling</span> <span data-start="547.62" data-end="552.3">came about with Sass, Less and Stylus  and all of those preprocessor tools</span> <span data-start="552.3" data-end="554.13">That was when Ruby was like really big</span> <span data-start="554.13" data-end="557.52">and they were written in Ruby and was sort of clunky and slow because then you</span> <span data-start="557.52" data-end="561.5">had to wait for your CSS to process before it was spit out</span> <span data-start="561.5" data-end="564.42">from Sass to CSS for example</span> <span data-start="564.42" data-end="568.56">and then Node came around and that  became a lot faster and Sass was rewritten</span> <span data-start="568.56" data-end="572.42">and people were still using a lot of  the benefits from that language</span> <span data-start="572.42" data-end="577.92">the Sass language and then  PostCSS sort of replaced a lot of that need</span> <span data-start="577.92" data-end="581.16">because it allowed for you to do some of  these same things but instead of</span> <span data-start="581.16" data-end="586.84">pre-processing and waiting for the developer to see their CSS file be exported</span> <span data-start="586.84" data-end="590.46">you could then run through the CSS file after you had already written it</span> <span data-start="590.46" data-end="594.88">and then apply transformations and changes with PostCSS and</span> <span data-start="594.88" data-end="602.07">that also enabled you to have pluggable very small bits of code that was way less robust</span> <span data-start="602.07" data-end="609.51">and just large in terms of developer fingerprint in your dev files in your</span> <span data-start="609.51" data-end="615">architecture by enabling like these small plugins like a autoprefixer plugin</span> <span data-start="615" data-end="619.2">or something like for size where if you wanted to use a size keyword you could</span> <span data-start="619.2" data-end="621.75">use that you could even write your own so that was really cool</span> <span data-start="621.75" data-end="625.14">and I think that that has continued to the state people use PostCSS all the</span> <span data-start="625.14" data-end="629.64">time and now you're seeing a lot of additional CSS tools that allow for</span> <span data-start="629.64" data-end="633.42">things like tree shaking and some of these optimizations that are beyond just</span> <span data-start="633.42" data-end="638.94">minification and that is really coincided with the switch to framework</span> <span data-start="638.94" data-end="645.36">based JavaScript as being so prevalent in the way we architect our projects now</span> </p>
<p><span data-start="645.36" data-end="650.7">You know naturally I think CSS in JS happens or maybe it's JS in your CSS</span> <span data-start="650.7" data-end="656.46">but it's sort of like inevitably what will happen is you'll find a moment</span> <span data-start="656.46" data-end="660.12">where you needed something that was just so richly dynamic that some you know</span> <span data-start="660.12" data-end="665.22">declarative static styles might not work for so I've been putting you know CSS in</span> <span data-start="665.22" data-end="669.04">my JS for a long time but if we're talking about the new CSS in JS libraries</span> <span data-start="669.04" data-end="671.08">sort of take your object notation or let</span> <span data-start="671.089" data-end="675.05">you do extending and abstracting in different ways at the client side</span> <span data-start="675.05" data-end="679.82">those are great too they all all options for writing styles still have foot guns</span> <span data-start="679.82" data-end="683.76">so you just need to be careful and you'll  learn your tool the more you use it</span> <span data-start="683.76" data-end="688.02">[Mariko] okay so what's the quarks when dealing with assets</span> <span data-start="688.02" data-end="689.4">Yeah, so..</span> <span data-start="689.4" data-end="695.14">I mean webpack has like a super long history with various techniques for doing this</span> <span data-start="695.14" data-end="701.75">at its simplest there are tools for essentially you can take a loader which</span> <span data-start="701.75" data-end="706.07">is a transform you apply to a module and you can apply that to something that</span> <span data-start="706.07" data-end="711.56">isn't JavaScript to turn it into a string in a JavaScript file</span> <span data-start="711.56" data-end="716.779">and so like historically the way that assets have worked in in webpack has tended to</span> <span data-start="716.779" data-end="721.67">center around turning them into a JavaScript thing even for assets where</span> <span data-start="721.67" data-end="726.38">the asset itself might have dependencies either on JavaScript or on other assets</span> <span data-start="726.38" data-end="730.73">it will turn that into a JavaScript module with a string and turn the</span> <span data-start="730.73" data-end="737.9">dependencies, you know the CSS import statements, into JavaScript require calls</span> <span data-start="737.9" data-end="741.77">and so it will sort of inject them into the graph by converting them to the</span> <span data-start="741.77" data-end="743.34">equivalent JavaScript code</span> <span data-start="743.34" data-end="747.2">[Mariko] Now this is changing in webpack 5 but for other</span> <span data-start="747.2" data-end="752.3">tools like Parcel assets has been a center of it from the beginning</span> </p>
<p><span data-start="752.3" data-end="756.13">One thing it sets parcel apart for many others that they actually don't use</span> <span data-start="756.13" data-end="760.97">JavaScript as the entry point but HTML so what is considered an asset and many</span> <span data-start="760.97" data-end="765.86">other build tools is their main entry points for in Parcel land and that makes</span> <span data-start="765.86" data-end="769.58">sense because on the web that is the thing we go to we go to HTML pages and</span> <span data-start="769.58" data-end="774.41">from there on we reference assets so whether you're reference an image from</span> <span data-start="774.41" data-end="779.57">JavaScript or from within HTML, Parcel will understand that and that's actually</span> <span data-start="779.57" data-end="784.49">really cool and it does this to many many layers so if your reference a CSS</span> <span data-start="784.49" data-end="789.589">file from HTML and that CSS file references in images all of these things</span> <span data-start="789.589" data-end="793.82">are tracked by Parcel and there will be hashed and they will get a version</span> <span data-start="793.82" data-end="798.08">number and whatnot so it actually builds an entire asset graph</span> <span data-start="798.08" data-end="802.14">[Marko] What Surma just explained is called asset hash cascading</span> <span data-start="802.14" data-end="807.1">if one file in a graph is updated, then the file hash changes</span> <span data-start="807.1" data-end="813.32">and because of that, hash of the file that used the updated asset should also change</span> <span data-start="813.32" data-end="818.44">this is important so that we can control cache for better performance</span> <span data-start="818.44" data-end="821.1">let's see how Rollup handles it</span> </p>
<p><span data-start="821.1" data-end="826.08">Yeah so right now hashing is Rollup's weakness</span> <span data-start="826.08" data-end="828.46">and it's something they know about and it's something</span> <span data-start="828.46" data-end="831.6">they are going to be working on fixing very very soon</span> <span data-start="831.6" data-end="835.96">so when you generate the hash for a file you know</span> <span data-start="835.96" data-end="840.32">that little bit of the file names to go at the end, all of the hex letters and numbers</span> <span data-start="840.32" data-end="845.33">you need to do that as late in the process as possible and you want</span> <span data-start="845.33" data-end="848.44">it to just be based on the contents of the file like not the directory it's in</span> <span data-start="848.44" data-end="850.72">not your config settings anything like that</span> <span data-start="850.72" data-end="853.8">if you've got JavaScript which imports JavaScript which imports JavaScript</span> <span data-start="853.8" data-end="855.96">it does the right thing with hashing</span> <span data-start="855.96" data-end="859.84">you know you change a leaf one  and it changes all of the other ones in the chain</span> <span data-start="859.84" data-end="861.94">because you know all the URLs have updated</span> <span data-start="861.94" data-end="866.34">whereas with assets you use a magic string in Rollup to</span> <span data-start="866.34" data-end="870.78">to..and Rollup will change that to be the assets URL but it does that after hashing</span> <span data-start="870.78" data-end="873.86">so you update your asset it changes hash</span> <span data-start="873.86" data-end="878.58">it updates the JavaScript file fine  but it doesn't update the hash of that JavaScript</span> <span data-start="878.58" data-end="882.26">so, it's a weakness but they are fixing it</span> <span data-start="882.26" data-end="887.56">[Mariko] these differences and gotchas in our build tools are constant source of frustration</span> <span data-start="887.56" data-end="892.72">as Una said, the best tool for the job really depends on your project</span> </p>
<p><span data-start="892.72" data-end="897.74">And so, we wanted to make it easier for you to navigate this landscape</span> <span data-start="897.74" data-end="901.74">tooling.report is a new website that gives developers like you</span> <span data-start="901.74" data-end="906.04">an overview of various features supported by different build tools</span> <span data-start="906.04" data-end="911.18">we built this website so you can evaluate and choose the right tools for your next project</span> <span data-start="911.18" data-end="915.62">or maybe you are in the middle of migrating frontend infrastructure</span> <span data-start="915.62" data-end="917.08">and hitting a road block</span> <span data-start="917.08" data-end="920.78">tooling.report should help you answer your questions</span> <span data-start="920.78" data-end="924.7">we've essentially written a test suite for different tools</span> <span data-start="924.7" data-end="927.08">based on common web development practices</span> <span data-start="927.08" data-end="930.06">so you can read why those tests are relevant</span> <span data-start="930.06" data-end="932.96">and see how each tool handles it</span> <span data-start="932.96" data-end="935.94">and when you are ready to implement it yourself</span> <span data-start="935.94" data-end="943.5">you can look at our test code to see how you might integrate certain features into your build setup</span> <span data-start="943.5" data-end="948.08">we also welcome your contributions so if you think certain features should get tested</span> <span data-start="948.08" data-end="951.06">please raise an issue on the repo</span> </p>
</section>

<!-- div#container ends -->
</div>

<img alt="The End" id="fin" src="../images/fin.jpg">

<script>
/*eslint-disable */
function googleTranslateElementInit() {
  new google.translate.TranslateElement({pageLanguage: 'en',
    layout: google.translate.TranslateElement.InlineLayout.SIMPLE
    }, 'google-translate');
}
/* eslint-enable */
</script>

<script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<script src="../js/main.js"></script>

</body>

</html>
